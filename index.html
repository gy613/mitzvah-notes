<script>
document.addEventListener("DOMContentLoaded", function () {
    function getRandomItem(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
    }

    const mitzvahActions = {
        "Modern Orthodox": {
            "Honoring parents": [
                "didn’t roll their eyes when their father told an embarrassing Dad Joke",
                "paused their TikTok to answer mommy’s question",
                "pretended to listen when dad explained how high-yield savings accounts work"
            ],
            "Giving tzedakah": [
                "donated some of their crypto to charity",
                "planted a tree for Israel",
                "gave a dollar to tzedakah", 
                "helped a friend in need", 
                "donated their old toys to charity"
            ],
            "Keeping Shabbat": [
                "didn't turn on their phone until after Havdalah",
                "DVR'd the big game and waited until Shabbat was over to watch it"
            ],
            "Hashavat Aveidah": [
                "returned a lost puppy",
                "found a lost pencil and gave it back", 
                "returned a missing glove to a classmate"
            ],
            "Bal Tashchit": [
                "only took one ketchup packet instead of hoarding an entire handful",
                "ate their entire plate of food… except for the vegetables, which don’t count",
                "used both sides of the paper instead of just one like a savage"
            ]
        },

        "Standard": {
            "Honoring parents": [
                "cleared the dinner table without being asked",
                "helped their mother carry in the groceries without throwing a fit",
                "gave their father a hug BEFORE asking for money"
            ],
            "Giving tzedakah": [
                "put a quarter in the tzedakah box and felt like a big gvir",
                "gave a dollar to tzedakah", 
                "helped a friend in need", 
                "donated their old toys"
            ],
            "Hashavas Aveidah": [
                "returned a lost puppy",
                "found a lost pencil and gave it back", 
                "returned a missing glove to a classmate"
            ]
        }
    };

    const templates = {
        "Modern Orthodox": [
            "Dear Morah, {child} performed the mitzvah of {mitzvah} by {action}. What a role model!"
        ],
        "Standard": [
            "Dear Morah, {child} did an incredible mitzvah today! They engaged in {mitzvah} by {action}."
        ]
    };

    window.generateNote = function () {
        let childName = document.getElementById("child_name").value.trim();
        let tone = document.getElementById("tone").value;

        if (!childName) {
            alert("Please enter a child's name!");
            return;
        }

        let toneSpecificMitzvos = mitzvahActions[tone];

        if (!toneSpecificMitzvos || Object.keys(toneSpecificMitzvos).length === 0) {
            alert("No mitzvot found for this tone.");
            return;
        }

        let mitzvah = getRandomItem(Object.keys(toneSpecificMitzvos));
        let action = getRandomItem(toneSpecificMitzvos[mitzvah]);
        let template = getRandomItem(templates[tone]);

        let mitzvahNote = template.replace("{child}", childName)
                                  .replace("{mitzvah}", mitzvah.toLowerCase())
                                  .replace("{action}", action);

        document.getElementById("mitzvah-note").innerHTML = `<h3>Mitzvah Note:</h3><p>${mitzvahNote}</p>`;
        document.getElementById("mitzvah-note").style.display = "block";
    };
});
</script>
